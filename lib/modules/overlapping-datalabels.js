!function(a){var t=a.Chart,n=a.each,e=a.pick,i=a.addEvent;t.prototype.callbacks.push(function(a){function t(){var t=[];n(a.series,function(a){var i=a.options.dataLabels,l=a.dataLabelCollections||["dataLabel"];(i.enabled||a._hasPointLabels)&&!i.allowOverlap&&a.visible&&n(l,function(i){n(a.points,function(a){a[i]&&(a[i].labelrank=e(a.labelrank,a.shapeArgs&&a.shapeArgs.height),t.push(a[i]))})})}),a.hideOverlappingLabels(t)}t(),i(a,"redraw",t)}),t.prototype.hideOverlappingLabels=function(a){var t,e,i,l,r,o,p,c,s,h,d,u=a.length,b=function(a,t,n,e,i,l,r,o){return!(i>a+n||i+r<a||l>t+e||l+o<t)};for(e=0;e<u;e++)t=a[e],t&&(t.oldOpacity=t.opacity,t.newOpacity=1);for(a.sort(function(a,t){return(t.labelrank||0)-(a.labelrank||0)}),e=0;e<u;e++)for(l=a[e],i=e+1;i<u;++i)r=a[i],l&&r&&l.placed&&r.placed&&0!==l.newOpacity&&0!==r.newOpacity&&(p=l.alignAttr,c=r.alignAttr,s=l.parentGroup,h=r.parentGroup,d=2*(l.box?0:l.padding),o=b(p.x+s.translateX,p.y+s.translateY,l.width-d,l.height-d,c.x+h.translateX,c.y+h.translateY,r.width-d,r.height-d),o&&((l.labelrank<r.labelrank?l:r).newOpacity=0));n(a,function(a){var t,n;a&&(n=a.newOpacity,a.oldOpacity!==n&&a.placed&&(n?a.show(!0):t=function(){a.hide()},a.alignAttr.opacity=n,a[a.isOld?"animate":"attr"](a.alignAttr,null,t)),a.isOld=!0)})}}(Highcharts);