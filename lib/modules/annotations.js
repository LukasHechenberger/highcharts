!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){function e(t){var e,i;return i={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}},e={circle:{params:{x:0,y:0}}},e[t]&&(i.shape=u(i.shape,e[t])),i}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return t!==s&&null!==t}function a(t,e,i,n,a){for(var s=t.length,r=0;r<s;)c(t[r])&&c(t[r+1])?(t[r]=e.toPixels(t[r])-n,t[r+1]=i.toPixels(t[r+1])-a,r+=2):r+=1;return t}var s,r,o,l=t.Chart,h=t.extend,p=t.each,c=t.isNumber;o=["path","rect","circle"],r={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var d=t.inArray,u=t.merge,x=function(){this.init.apply(this,arguments)};x.prototype={init:function(t,i){var n=i.shape&&i.shape.type;this.chart=t,this.options=u({},e(n),i)},render:function(t){var e=this,i=this.chart,n=e.chart.renderer,a=e.group,s=e.title,r=e.shape,l=e.options,h=l.title,p=l.shape;a||(a=e.group=n.g()),!r&&p&&d(p.type,o)!==-1&&(r=e.shape=n[l.shape.type](p.params),r.add(a)),!s&&h&&(s=e.title=n.label(h),s.add(a)),a.add(i.annotations.group),e.linkObjects(),t!==!1&&e.redraw()},redraw:function(){var e,i,s,o,l,p,u,x=this.options,f=this.chart,y=this.group,g=this.title,m=this.shape,b=this.linkedObject,v=f.xAxis[x.xAxis],w=f.yAxis[x.yAxis],k=x.width,P=x.height,j=r[x.anchorY],O=r[x.anchorX];if(b&&(i=b instanceof t.Point?"point":b instanceof t.Series?"series":null,"point"===i?(x.xValue=b.x,x.yValue=b.y,s=b.series):"series"===i&&(s=b),y.visibility!==s.group.visibility&&y.attr({visibility:s.group.visibility})),p=n(x.xValue)?v.toPixels(x.xValue+v.minPointOffset)-v.minPixelPadding:x.x,u=n(x.yValue)?w.toPixels(x.yValue):x.y,c(p)&&c(u)){if(g&&(g.attr(x.title),g.css(x.title.style)),m){if(e=h({},x.shape.params),"values"===x.units){for(o in e)d(o,["width","x"])>-1?e[o]=v.translate(e[o]):d(o,["height","y"])>-1&&(e[o]=w.translate(e[o]));e.width&&(e.width-=v.toPixels(0)-v.left),e.x&&(e.x+=v.minPixelPadding),"path"===x.shape.type&&a(e.d,v,w,p,u)}"circle"===x.shape.type&&(e.x+=e.r,e.y+=e.r),m.attr(e)}y.bBox=null,c(k)||(l=y.getBBox(),k=l.width),c(P)||(l||(l=y.getBBox()),P=l.height),c(O)||(O=r.center),c(j)||(j=r.center),p-=k*O,u-=P*j,f.animation&&n(y.translateX)&&n(y.translateY)?y.animate({translateX:p,translateY:u}):y.translate(p,u)}},destroy:function(){var t=this,e=this.chart,i=e.annotations.allItems,n=i.indexOf(t);n>-1&&i.splice(n,1),p(["title","shape","group"],function(e){t[e]&&(t[e].destroy(),t[e]=null)}),t.group=t.title=t.shape=t.chart=t.options=null},update:function(t,e){h(this.options,t),this.linkObjects(),this.render(e)},linkObjects:function(){var t=this,e=t.chart,i=t.linkedObject,a=i&&(i.id||i.options.id),s=t.options,r=s.linkedTo;n(r)?n(i)&&r===a||(t.linkedObject=e.get(r)):t.linkedObject=null}},h(l.prototype,{annotations:{add:function(t,e){var n,a,s=this.allItems,r=this.chart;for(i(t)||(t=[t]),a=t.length;a--;)n=new x(r,t[a]),s.push(n),n.render(e)},redraw:function(){p(this.allItems,function(t){t.redraw()})}}}),l.prototype.callbacks.push(function(e){var n,a=e.options.annotations;n=e.renderer.g("annotations"),n.attr({zIndex:7}),n.add(),e.annotations.allItems=[],e.annotations.chart=e,e.annotations.group=n,i(a)&&a.length>0&&e.annotations.add(e.options.annotations),t.addEvent(e,"redraw",function(){e.annotations.redraw()})})});