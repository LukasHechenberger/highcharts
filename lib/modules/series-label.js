!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){function e(t,e,o,h,r,i){var a=(i-e)*(o-t)-(h-e)*(r-t);return a>0||!(a<0)}function o(t,o,h,r,i,a,n,c){return e(t,o,i,a,n,c)!==e(h,r,i,a,n,c)&&e(t,o,h,r,i,a)!==e(t,o,h,r,n,c)}function h(t,e,h,r,i,a,n,c){return o(t,e,t+h,e,i,a,n,c)||o(t+h,e,t+h,e+r,i,a,n,c)||o(t,e+r,t+h,e+r,i,a,n,c)||o(t,e,t,e+r,i,a,n,c)}function r(t){var e=this;t.call(e),clearTimeout(e.seriesLabelTimer),e.seriesLabelTimer=setTimeout(function(){e.boxesToAvoid=[],n(e.series,function(t){var o=t.options.label;o.enabled&&t.visible&&(t.graph||t.area)&&(t.interpolatedPoints=t.getPointsOnGraph(),n(o.boxesToAvoid||[],function(t){e.boxesToAvoid.push(t)}))}),n(e.series,function(t){function o(t,e,o){return t>d&&t<=d+w-o.width&&e>=g&&e<=g+b-o.height}var h,r,a,n,s,l,p=[],u=e.inverted,d=u?t.yAxis.pos:t.xAxis.pos,g=u?t.xAxis.pos:t.yAxis.pos,w=e.inverted?t.yAxis.len:t.xAxis.len,b=e.inverted?t.xAxis.len:t.yAxis.len,f=t.interpolatedPoints;if(t.visible&&f){for(t.labelBySeries||(t.labelBySeries=e.renderer.label(t.name,0,-9999,"connector").css(c({color:t.color},t.options.label.styles)).attr({padding:0,opacity:0,stroke:t.color,"stroke-width":1}).add(t.group).animate({opacity:1},{duration:200})),h=t.labelBySeries.getBBox(),h.width=Math.round(h.width),s=f.length-1;s>0;s-=1)r=f[s].chartX+i,a=f[s].chartY-h.height-i,o(r,a,h)&&(l=t.checkClearPoint(r,a,h)),l&&p.push(l),r=f[s].chartX+i,a=f[s].chartY+i,o(r,a,h)&&(l=t.checkClearPoint(r,a,h)),l&&p.push(l),r=f[s].chartX-h.width-i,a=f[s].chartY+i,o(r,a,h)&&(l=t.checkClearPoint(r,a,h)),l&&p.push(l),r=f[s].chartX-h.width-i,a=f[s].chartY-h.height-i,o(r,a,h)&&(l=t.checkClearPoint(r,a,h)),l&&p.push(l);if(!p.length)for(r=d+w-h.width;r>=d;r-=16)for(a=g;a<g+b-h.height;a+=16)n=t.checkClearPoint(r,a,h,!0),n&&p.push(n);p.length?(p.sort(function(t,e){return e.weight-t.weight}),l=p[0],e.boxesToAvoid.push({left:l.x,right:l.x+h.width,top:l.y,bottom:l.y+h.height}),Math.round(l.x)===Math.round(t.labelBySeries.x)&&Math.round(l.y)===Math.round(t.labelBySeries.y)||t.labelBySeries.attr({x:l.x-d,y:l.y-g,anchorX:l.connectorPoint&&l.connectorPoint.plotX,anchorY:l.connectorPoint&&l.connectorPoint.plotY,opacity:0}).animate({opacity:1})):t.labelBySeries&&(t.labelBySeries=t.labelBySeries.destroy())}})},350)}var i=3,a=t.wrap,n=t.each,c=t.extend,s=t.isNumber,l=t.Series,p=t.SVGRenderer,u=t.Chart;Highcharts.setOptions({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!0,connectorNeighbourDistance:24,styles:{fontWeight:"bold"}}}}}),p.prototype.symbols.connector=function(t,e,o,h,r){var i,a,n=r&&r.anchorX,c=r&&r.anchorY,l=o/2;return s(n)&&s(c)&&(i=["M",n,c],a=e-c,a<0&&(a=-h-a),a<o&&(l=n<t+o/2?a:o-a),c>e+h?i.push("L",t+l,e+h):c<e?i.push("L",t+l,e):n<t?i.push("L",t,e+h/2):n>t+o&&i.push("L",t+o,e+h/2)),i||[]},l.prototype.getPointsOnGraph=function(){var t,e,o,h,r,i,a,n,c,l,p=16,u=this.points,d=[],g=this.graph||this.area,w=g.element,b=this.chart.inverted,f=b?this.yAxis.pos:this.xAxis.pos,X=b?this.xAxis.pos:this.yAxis.pos;if(this.getPointSpline&&w.getPointAtLength){for(g.toD&&(l=g.attr("d"),g.attr({d:g.toD})),a=w.getTotalLength(),o=0;o<a;o+=p)t=w.getPointAtLength(o),d.push({chartX:f+t.x,chartY:X+t.y,plotX:t.x,plotY:t.y});l&&g.attr({d:l}),t=u[u.length-1],t.chartX=f+t.plotX,t.chartY=X+t.plotY,d.push(t)}else for(a=u.length,o=0;o<a;o+=1){if(t=u[o],e=u[o-1],t.chartX=f+t.plotX,t.chartY=X+t.plotY,o>0&&(h=Math.abs(t.chartX-e.chartX),r=Math.abs(t.chartY-e.chartY),i=Math.max(h,r),i>p))for(n=Math.ceil(i/p),c=1;c<n;c+=1)d.push({chartX:e.chartX+(t.chartX-e.chartX)*(c/n),chartY:e.chartY+(t.chartY-e.chartY)*(c/n),plotX:e.plotX+(t.plotX-e.plotX)*(c/n),plotY:e.plotY+(t.plotY-e.plotY)*(c/n)});s(t.plotY)&&d.push(t)}return d},l.prototype.checkClearPoint=function(t,e,o,r){function i(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function a(t,e){return t-e}var n,c,s,l,p,u,d,g=Number.MAX_VALUE,w=Number.MAX_VALUE,b=this.options.label.connectorAllowed,f=this.chart,X=16;for(u=0;u<f.boxesToAvoid.length;u+=1)if(i(f.boxesToAvoid[u],{left:t,right:t+o.width,top:e,bottom:e+o.height}))return!1;for(u=0;u<f.series.length;u+=1)if(s=f.series[u],l=s.interpolatedPoints,s.visible&&l){for(d=1;d<l.length;d+=1){if(h(t,e,o.width,o.height,l[d-1].chartX,l[d-1].chartY,l[d].chartX,l[d].chartY))return!1;this===s&&!p&&r&&(p=h(t-X,e-X,o.width+2*X,o.height+2*X,l[d-1].chartX,l[d-1].chartY,l[d].chartX,l[d].chartY)),this!==s&&(g=Math.min(g,Math.pow(t+o.width/2-l[d].chartX,2)+Math.pow(e+o.height/2-l[d].chartY,2),Math.pow(t-l[d].chartX,2)+Math.pow(e-l[d].chartY,2),Math.pow(t+o.width-l[d].chartX,2)+Math.pow(e-l[d].chartY,2),Math.pow(t+o.width-l[d].chartX,2)+Math.pow(e+o.height-l[d].chartY,2),Math.pow(t-l[d].chartX,2)+Math.pow(e+o.height-l[d].chartY,2)))}if(b&&this===s&&(r&&!p||g<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(d=1;d<l.length;d+=1)n=Math.min(Math.pow(t+o.width/2-l[d].chartX,2)+Math.pow(e+o.height/2-l[d].chartY,2),Math.pow(t-l[d].chartX,2)+Math.pow(e-l[d].chartY,2),Math.pow(t+o.width-l[d].chartX,2)+Math.pow(e-l[d].chartY,2),Math.pow(t+o.width-l[d].chartX,2)+Math.pow(e+o.height-l[d].chartY,2),Math.pow(t-l[d].chartX,2)+Math.pow(e+o.height-l[d].chartY,2)),n<w&&(w=n,c=l[d]);p=!0}}return!(r&&!p)&&{x:t,y:e,weight:a(g,c?w:0),connectorPoint:c}},a(u.prototype,"render",r),a(u.prototype,"redraw",r)});